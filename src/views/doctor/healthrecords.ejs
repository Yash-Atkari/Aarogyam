<%- layout("./layouts/doctorboilerplate") %>

<!-- Link external CSS -->
<link rel="stylesheet" href="/css/doctor/healthrecords.css">

<body>
    <div class="container">
        <h2>
            Medical Records for 
            <a href="" style="text-decoration: none;">
                <%= appointments[0].patientId.fullName || appointments[0].patientId.username %>
            </a>
        </h2>

        <!-- Custom responsive grid -->
        <div class="healthrecords-container">
            <% if (healthrecords && healthrecords.length > 0) { %>
                <% for (let record of healthrecords) { %>
                    <div class="healthrecord-card">
                        <h6 class="text-dark">
                            <i class="fa-solid fa-calendar"></i>&nbsp; Appointment on 
                            <%= new Date(record.created_at).toDateString() %>
                        </h6>
                    
                        <p><strong>Symptom:</strong> <%= record.symptoms %></p>
                        <p><strong>Disease:</strong> <%= record.disease %></p>

                        <% if (record.attachments && record.attachments.length > 0) { %>
                            <p><strong>Attachments:</strong></p>
                            <ul>
                                <% for (let file of record.attachments) { %>
                                    <li>
                                        <a href="<%= file %>" class="btn btn-primary" target="_blank">
                                            <i class="fa-solid fa-eye"></i> View
                                        </a>
                                        <a href="<%= file %>" class="btn btn-success" target="_blank" download>
                                            <i class="fa-solid fa-download"></i> Download
                                        </a>
                                    </li>
                                <% } %>
                            </ul>
                        <% } else { %>
                            <p class="text-muted">No attachments available</p>
                        <% } %>

                        <p class="text-muted badge">
                            <%= new Date(record.created_at).toDateString() %>
                        </p>
                    </div>
                <% } %>
            <% } else { %>
                <p>No health records available</p>
            <% } %>
        </div>
    </div>
</body>
